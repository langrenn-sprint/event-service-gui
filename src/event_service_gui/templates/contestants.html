{% extends "adm_base.html" %}

{% block titlecontainer %}
  <div class="w3-quart"></div>
  <div class="w3-half">
{% endblock %}

{% block titleheader %}
  {{ lopsinfo }}
{% endblock %}
{% block refresh %}{% endblock %}
{% block titlemain %}{{ lopsinfo }}{% endblock %}
{% block menuitems %}
  <li id=topborder>
    <a href=/events?eventid={{ eventid }} class=dropbtn>Info</a>
  </li>
  <li id=topborder class=active>
    <a href=/contestants?eventid={{ eventid }} class=dropbtn>Deltakere</a>
  </li>
  <li id=topborder>
    <a href=/raceclasses?eventid={{ eventid }} class=dropbtn>Klasser</a>
  </li>
  <li id=topborder>
    <a href=/schedules?eventid={{ eventid }} class=dropbtn>Kjøreplan</a>
  </li>
{% endblock %}

{% block content %}
    {% if create_new %}
    <form action=/contestants method=post enctype="multipart/form-data" >
      <table cellpadding=4>
        <tr id=spacer></tr>
        <tr>
          <td colspan=2 id=headerblue>
            <b>Importer deltakerliste fra fil</b>
          </td>
        </tr>
        <tr>
          <td>
            <input type="file" name="file" onchange="savefile(this)">
          </td>
          <td>
            <input type="hidden" name=eventid value="{{ eventid }}">
            <input type="submit" name=create value="  Last opp  ">
          </td>
        </tr>
        <tr>
          <td colspan=2>
            <br>Informasjon
          </td>
        </tr>
        <tr>
          <td colspan=2>
            To typer filer aksepteres:<br>
            1. XML: SSF XML - eksportert fra Sportsadmin. <br>
            2. CSV: NSF XLS - kommaseparert fil med alle deltakere. <br>
            Start med å eksportere deltakerliste fra Sportsadmin. Brukerveiledning for eksportering finnes i <a href="https://itinfo.nif.no/SportsAdmin_Arrangement#Eksportere_til_Excel_og_XML" target=_blank>Sportsadmin</a>.
          </td>
        </tr>
        <tr id=spacer></tr>
      </table>
    </form>
    {% elif edit_mode %}
      <div id=spacer></div>
        <table>
          <tr id=headerblue>
            <td>Startnr</td>
            <td>Navn</td>
            <td>Klubb</td>
            <td>Klasse</td>
            <td>Team</td>
            <td></td>
          </tr>
          {% for contestant in contestants %}
          <form action=/contestants method=post>
            <tr>
              <td><input type=text name="startnr" value="{{ contestant.startnr }}"></td>
              <td>{{ contestant.first_name }} {{ contestant.last_name }}</td>
              <td>{{ contestant.club }}</td>
              <td><input type=text name="ageclass" value="{{ contestant.ageclass }}"></td>
              <td>
                {{ contestant.team }}
                <input type=hidden name="id" value="{{ contestant.id }}">
                <input type="hidden" name="eventid" value="{{ eventid }}">
              </td>
              <td><input type="submit" name=update value="  Oppdater  "></td>
            </tr>
          </form>
          {% endfor %}
        </table>
      {% else %}
        <div id=spacer></div>
        <table>
          <tr id=headerblue>
            <td align=right>
              <form action=/contestants method=get>
                <input type="hidden" name="eventid" value="{{ eventid }}">
                <input type="submit" name=edit_mode value="  Rediger  ">
              </form>
            </td>
            <td>
              <form action=/contestants method=get>
                <input type="hidden" name=eventid value="{{ eventid }}">
                <input type="submit" name=new value="  Last inn deltakere fra fil ">
              </form>
            </td>
          </tr>
        </table>
      <div id=spacer></div>
      <table>
        <tr id=headerblue>
          <td>Startnr</td>
          <td>Navn</td>
          <td>Klubb</td>
          <td>Klasse</td>
          <td>Team</td>
        </tr>
          {% for contestant in contestants %}
            <tr>
              <td>{{ contestant.startnr }}</td>
              <td>{{ contestant.first_name }} {{ contestant.last_name }}</td>
              <td>{{ contestant.club }}</td>
              <td>{{ contestant.ageclass }}</td>
              <td>{{ contestant.team }}</td>
            </tr>
            {% endfor %}
        <tr id=spacer></tr>
      </table>
    {% endif %}
  {% endblock %}
