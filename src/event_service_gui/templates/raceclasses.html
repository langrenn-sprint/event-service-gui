{% extends "adm_base.html" %}
{% block titlecontainer %}
  <div class="w3-quart"></div>
  <div class="w3-half">
{% endblock %}
{% block titleheader %}
  {{ lopsinfo }}
{% endblock %}
{% block refresh %}{% endblock %}
{% block titlemain %}{{ lopsinfo }}{% endblock %}
{% block menuitems %}
  <li id=topborder>
    <a href=/events?eventid={{ eventid }} class=dropbtn>Info</a>
  </li>
  <li id=topborder>
    <a href=/contestants?eventid={{ eventid }} class=dropbtn>Deltakere</a>
  </li>
  <li id=topborder class=active>
    <a href=/raceclasses?eventid={{ eventid }} class=dropbtn>Klasser</a>
  </li>
  <li id=topborder>
    <a href=/schedules?eventid={{ eventid }} class=dropbtn>Kjøreplan</a>
  </li>
{% endblock %}

{% block content %}
  <div id=spacer></div>
  {% if  action == "edit_mode" %}
      <table>
        <tr id=headerblue align=right>
          <td>
            <form action=/raceclasses method=post>
              <input type="hidden" name="eventid" value="{{ eventid }}">
              <input type="submit" name="refresh_contestants" value="  Refresh deltakerantall  ">
            </form>
          </td>
          <td>
            <form action=/raceclasses method=post>
              <input type="hidden" name="eventid" value="{{ eventid }}">
              <input type="submit" name="generate_ageclasses" value="  Generer årsklasser  ">
            </form>
          </td>
      </table>
    <div id=spacer></div>
      <table>
         <tr id=headerblue>
          <td>Årsklasse</td>
          <td>Løype</td>
          <td>Løpsklasse</td>
          <td>Startrekkefølge</td>
          <td>Deltakere</td>
          <td></td>
          <td></td>
        </tr>
        {% for klasse in ageclasses %}
            <tr>
              <td>{{ klasse.age_class }}</td>
              <td>{{ klasse.distance }}</td>
              <td>{{ klasse.race_class }}</td>
              <td>{{ klasse.order }}</td>
              <td>{{ klasse.contestants }}</td>
              <td>
                <form action=/raceclasses method=get>
                  <input type="submit" name=update_one value="  Rediger  ">
                  <input type="hidden" name=action value="update_one">
                  <input type="hidden" name="id" value="{{ klasse.id }}">
                  <input type="hidden" name="eventid" value="{{ eventid }}">
                </form>
              </td>
              <td>
                <form action=/raceclasses method=post>
                  <input type="submit" name=delete_one value="  Slett  ">
                  <input type="hidden" name="id" value="{{ klasse.id }}">
                  <input type="hidden" name="eventid" value="{{ eventid }}">
                </form>
              </td>
            </tr>
        {% endfor %}
      </table>
      {% elif action == "update_one" %}
        <div id=spacer></div>
        <form action=/raceclasses method=post>
          <table cellpadding=4>
            <tr id=spacer></tr>
            <tr>
              <td colspan=3 id=headerblue>
                <b>Oppdater klasse</b>
              </td>
            </tr>
            <tr>
              <td width=150>Klasse</td>
              <td><input type=text name="age_class" value="{{ klasse.age_class }}"></td>
              <td></td>
            </tr>
            <tr>
              <td>Distanse</td>
              <td><input type=text name="distance" value="{{ klasse.distance }}"></td>
              <td></td>
            </tr>
            <tr>
              <td>Startrekkefølge</td>
              <td><input type=text name="order" value="{{ klasse.order }}"></td>
              <td></td>
            </tr>
            <tr>
              <td>Løpsklasse</td>
              <td><input type=text name="race_class" value="{{ klasse.race_class }}"></td>
              <td></td>
            </tr>
            <tr>
              <td>Deltakere</td>
              <td><input type=text name="contestants" value="{{ klasse.contestants }}"></td>
              <td></td>
            </tr>
            <tr>
                <td></td>
                <td>
                  <input type="hidden" name="eventid" value="{{ eventid }}">
                  <input type="hidden" name="id" value="{{ klasse.id }}">
                  <input type="submit" name=update_one value="  Oppdater  ">
                </td>
                <td></td>
            </tr>
            <tr id=spacer></tr>
          </table>
        </form>
  {% else %}
    <div align=right>
            <form action=/raceclasses method=get>
              <input type="hidden" name="eventid" value="{{ eventid }}">
              <input type="hidden" name=action value="edit_mode">
              <input type="submit" value="  Rediger  ">
            </form>
    </div>
    <div id=spacer></div>
    <table>
       <tr id=headerblue>
        <td>Årsklasse</td>
        <td>Løype</td>
        <td>Løpsklasse</td>
        <td>Startrekkefølge</td>
        <td>Deltakere</td>
      </tr>
      {% for klasse in ageclasses %}
          <tr>
            <td>{{ klasse.age_class }}</td>
            <td>{{ klasse.distance }}</td>
            <td>{{ klasse.race_class }}</td>
            <td>{{ klasse.order }}</td>
            <td>{{ klasse.contestants }}</td>
          </tr>
      {% endfor %}
    </table>
  {% endif %}
{% endblock %}
