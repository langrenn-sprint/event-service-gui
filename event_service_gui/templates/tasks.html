{% extends "adm_base.html" %}
{% block titlecontainer %}
  <div class="w3-10"></div>
  <div class="w3-80">
{% endblock %}

{% block titleheader %}{{ lopsinfo }}{% endblock %}
{% block refresh %}{% endblock %}
{% block titlemain %}{{ lopsinfo }}{% endblock %}
{% block content %}
  <div id=spacer></div>
  <table cellpadding=4>
    <tr>
      <td valign=top>
        <table>
          <tr id=subheader id=black>
            <td id=black>Arbeidsflyt - før rennet</td>
            <td width=150>Status</td>
            <td></td>
          </tr>
          <tr>
            <td>1. Arrangement: Opprett (<a id=orange href=/events?event_id={{ event_id }} class=dropbtn>se/endre</a>)</td>
            <td id=green>Utført</td>
            <td></td>
          </tr>
          <tr>
            <td colspan=3 id=spacer></td>
          </tr>
          <tr>
            <td>
              2. Deltakere: Last inn (<a id=orange href=/contestants?event_id={{ event_id }} class=dropbtn>se/endre</a>)
            </td>
            {% if (task_status.done_2) %}
              <td id=green>Utført</td>
              <td>{{ task_status.no_of_contestants}} deltakere.</td>
            {% else %}
              <td id=red>Mangler</td>
              <td>
                  <form action=/contestants method=get>
                    <input type="hidden" name=event_id value="{{ event_id }}">
                    <input type="hidden" name=action value="new_from_file">
                    <input type="submit" name=new_from_file value="  Last inn deltakere fra fil  ">
                  </form>
              </td>
            {% endif %}
          </tr>
          <tr>
            <td colspan=3 id=spacer></td>
          </tr>
          <tr>
            <td>3. Klasser: Opprett (<a id=orange href=/raceclasses?event_id={{ event_id }} class=dropbtn>se/endre</a>)</td>
            {% if (task_status.done_3) %}
              <td id=green>Utført</td>
              <td>{{ task_status.no_of_raceclasses}} klasser.</td>
            {% else %}
              <td id=red>Mangler</td>
              <td>
                {% if (task_status.done_2) %}
                  <form action=/raceclasses method=post>
                    <input type="hidden" name="event_id" value="{{ event_id }}">
                    <input type="submit" name="generate_raceclasses" value="  Generer klasser  ">
                  </form>
                {% endif %}
              </td>
            {% endif %}
          </tr>
          <tr>
            <td colspan=3 id=spacer></td>
          </tr>
          <tr>
            <td>4. Klasser: Startrekkefølge (<a id=orange href=/contestants?event_id={{ event_id }}&action=update_order class=dropbtn>se/endre</a>)</td>
            {% if (task_status.done_4) %}
              <td id=green>Utført</td>
              <td></td>
            {% else %}
              <td id=red>Mangler</td>
              <td>
                {% if (task_status.done_3) %}
                  <form action=/raceclasses method=get>
                    <input type="hidden" name="event_id" value="{{ event_id }}">
                    <input type="hidden" name=action value="update_order">
                    <input type="submit" name="generate_raceclasses" value="  Rediger startrekkefølge  ">
                  </form>
                {% endif %}
              </td>
            {% endif %}
          </tr>
          <tr>
            <td colspan=3 id=spacer></td>
          </tr>
          <tr>
            <td>5. Deltakere: Startnummer (<a id=orange href=/contestants?event_id={{ event_id }} class=dropbtn>se/endre</a>)</td>
            {% if (task_status.done_5) %}
              <td id=green>Utført</td>
              <td>{{ task_status.bib_missing}} deltakere mangler startnummer.</td>
            {% else %}
                {% if (task_status.no_of_contestants == task_status.bib_missing) %}
                  <td id=red>Mangler</td>
                  <td>
                    {% if (task_status.done_2) %}
                      <form action=/contestants method=post>
                        <input type="hidden" name=event_id value="{{ event_id }}">
                        <input type="submit" name=assign_bibs value="  Tildel startnummer  ">
                      </form>
                    {% endif %}
                  </td>
                {% else %}
                  <td id=orange>Delvis</td>
                  <td>{{ task_status.bib_missing}} deltakere mangler startnummer. </td>
                {% endif %}
            {% endif %}
          </tr>
          <tr>
            <td colspan=3 id=spacer></td>
          </tr>
          <tr>
            <td>6. Kjøreplan: Opprett (<a id=orange href=/raceplans?event_id={{ event_id }} class=dropbtn>se/endre</a>)</td>
            {% if (task_status.done_6) %}
              <td id=green>Utført</td>
              <td>{{ task_status.no_of_races}} heat er opprettet.</td>
            {% else %}
              <td id=red>Mangler</td>
              <td>
                {% if (task_status.done_4) %}
                  <form action=/raceplans method=post>
                    <input type="hidden" name="event_id" value="{{ event_id }}">
                    <input type="submit" name="generate_raceplan" value="  Generer kjøreplan  ">
                  </form>
                {% endif %}
              </td>
            {% endif %}
          </tr>
          <tr>
            <td colspan=3 id=spacer></td>
          </tr>
          <tr>
            <td>7. Kjøreplan: Tilpass tidksjema (<a id=orange href=/raceplans?event_id={{ event_id }}&action=edit_time} class=dropbtn>se/endre</a>)</td>
            <td>Manuell sjekk</td>
            <td>
              {% if (task_status.done_6) %}
                <form action=/raceplans method=get>
                  <input type="hidden" name="event_id" value="{{ event_id }}">
                  <input type="hidden" name=action value="edit_time">
                  <input type="submit" name="edit_time" value="  Tilpass tidskjema  ">
                </form>
              {% endif %}
            </td>
        </tr>
        <tr>
          <td colspan=3 id=spacer></td>
        </tr>
        <tr>
          <td>8. Startliste: Opprett (<a id=orange href={{ result_gui_url }}/start?event_id={{ event_id }} class=dropbtn>se/endre</a>)</td>
          {% if (task_status.done_8) %}
            <td id=green>Utført</td>
            <td> {{ task_status.no_of_starts }} starter er opprettet.</td>
          {% else %}
            <td id=red>Mangler</td>
            <td>
              {% if (task_status.done_6) %}
                <form action={{ result_gui_url }}/start method=post>
                  <input type="hidden" name="event_id" value="{{ event_id }}">
                  <input type="submit" name="generate_startlist" value="  Generer startliste  ">
                </form>
              {% endif %}
            </td>
          {% endif %}
        </tr>
        <tr>
          <td colspan=3 id=spacer></td>
        </tr>
        <tr>
          <td>9. "Videre til" oppsett: Opprett (<a id=orange href={{ result_gui_url }}/start?event_id={{ event_id }} class=dropbtn>se/endre</a>)</td>
          {% if (task_status.done_9) %}
            <td id=green>Utført</td>
            <td>
              {{ task_status.no_of_next_race }} <i>videre til</i> semi og finaler er opprettet.
              {% if (task_status.done_6) %}
                <form action={{ result_gui_url }}/start method=post>
                  <input type="hidden" name="event_id" value="{{ event_id }}">
                  <input type="submit" name="generate_next_race" value="  Generer på nytt  ">
                </form>
              {% endif %}
            </td>
          {% else %}
            <td id=red>Mangler</td>
            <td>
              {% if (task_status.done_6) %}
                <form action={{ result_gui_url }}/start method=post>
                  <input type="hidden" name="event_id" value="{{ event_id }}">
                  <input type="submit" name="generate_next_race" value="  Generer videre til oppsett  ">
                </form>
              {% endif %}
            </td>
          {% endif %}
        </tr>
        <tr>
          <td colspan=3 id=spacer></td>
        </tr>
        <tr>
          <td>10. Øvrige funksjoner</td>
          <td colspan=2>
            <form action=/tasks method=post>
              <input type="hidden" name="event_id" value="{{ event_id }}">
              <input type="submit" name="etteranmelding" value="  Etteranmelding  ">
            </form>
          </td>
        </tr>
        </table>
      </td>
      <td valign=top>
      </td>
    </tr>
  </table>
{% endblock %}
